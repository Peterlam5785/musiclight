<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>月子中心声光疗愈解决方案</title>
    <!-- 引入谷歌字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- 引入 Font Awesome 6 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #FFF8F4; /* Warm Ivory */
        }
        /* 页面容器，移除固定尺寸，使用 flex 布局使其居中 */
        .slide-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            width: 100%;
            padding: 2rem;
            box-sizing: border-box;
        }
        /* 单个幻灯片样式，使用相对单位 */
        .slide {
            width: 90%;
            max-width: 1280px;
            min-height: 70vh;
            position: relative;
            background-color: #FFF8F4;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-radius: 1rem;
            padding: 2rem 4rem;
            box-sizing: border-box;
            display: none; /* 默认隐藏所有幻灯片 */
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        /* 标题和副标题字体样式 */
        .title {
            font-family: 'Noto Serif SC', serif;
            color: #5A4A42;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
        }
        .subtitle {
            font-family: 'Noto Sans SC', sans-serif;
            font-weight: 300;
            color: #6B5750;
            font-size: 1.5rem;
        }
        .decorative-line {
            height: 3px;
            background: linear-gradient(90deg, #C7D3BF 0%, #E6D7E7 100%);
            border-radius: 3px;
            width: 80%;
            max-width: 24rem;
        }
        .highlight {
            color: #A57F75;
            font-weight: 500;
        }
        .accent-circle {
            position: absolute;
            border-radius: 50%;
            opacity: 0.3;
        }
        .accent-circle-1 {
            background-color: #C7D3BF;
            width: 12rem;
            height: 12rem;
            top: -5rem;
            right: -4rem;
        }
        .accent-circle-2 {
            background-color: #E6D7E7;
            width: 8rem;
            height: 8rem;
            bottom: -0.5rem;
            left: 5rem;
        }
        .image-container {
            width: 90%;
            max-width: 44rem;
            height: auto;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .light-card, .contact-card {
            background-color: #F8F4F1;
            border-radius: 1rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
            max-width: 24rem;
            margin: 1rem;
        }
        .light-card:hover, .contact-card:hover {
            transform: translateY(-5px);
        }
        .icon-container {
            width: 4rem;
            height: 4rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .d3-chart {
            width: 100%;
            height: 400px;
        }
        .contact-card .icon-container {
            width: 3.5rem;
            height: 3.5rem;
        }
        .control-buttons {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 1rem;
        }
        .control-buttons button {
            background-color: #A57F75;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .control-buttons button:hover {
            background-color: #8D6A62;
            transform: translateY(-2px);
        }
        .control-buttons button:disabled {
            background-color: #d1d5db;
            cursor: not-allowed;
            transform: none;
        }

        /* 针对不同幻灯片的背景色 */
        #slide-light-therapy { background-color: #C7D3BF; }
        #slide-sound-healing { background-color: #E6D7E7; }
    </style>
</head>
<body class="bg-[#F8F4F1]">

<!-- 主容器 -->
<div class="slide-container">

    <!-- 幻灯片 1：封面页 -->
    <div id="slide-cover" class="slide flex flex-col items-center justify-between relative p-8 md:p-12">
        <div class="accent-circle accent-circle-1 top-[-5rem] right-[-4rem]"></div>
        <div class="accent-circle accent-circle-2 bottom-[-0.5rem] left-[5rem]"></div>
        <div class="z-10 text-center mt-8 md:mt-16">
            <h1 class="title text-3xl md:text-5xl mb-4 md:mb-6">月子中心声光疗愈解决方案</h1>
            <div class="decorative-line w-64 md:w-96 mx-auto mb-4 md:mb-6"></div>
            <p class="subtitle text-lg md:text-2xl">为产后妈妈解决<span class="highlight">情绪</span>·<span class="highlight">睡眠</span>·<span class="highlight">身体恢复</span>三大难题</p>
        </div>
        <div class="image-container z-10 my-8 md:my-12">
            <img src="https://picture-search.skywork.ai/aippt/image/sheet/5873531dedc9a4bb5e6c010604ef9e02.jpg" alt="母婴温馨时刻" class="w-full h-auto object-cover rounded-xl" />
        </div>
        <div class="z-10 text-center text-[#8D7B74] text-sm md:text-base opacity-70 mt-auto">
            <p>基于先进的声光疗愈技术，提供个性化、科学化的产后恢复方案</p>
        </div>
    </div>

    <!-- 幻灯片 2：三大挑战 -->
    <div id="slide-challenges" class="slide flex-col items-center justify-center p-8 md:p-12">
        <div class="z-10 text-center">
            <h1 class="title text-3xl md:text-4xl mb-4">产后妈妈面临的三大挑战</h1>
            <p class="subtitle text-lg md:text-xl text-[#8D7B74]">关注妈妈的情绪、睡眠和身体恢复，是月子中心服务的核心</p>
        </div>
        <div id="challenge-chart" class="d3-chart mt-8 w-full max-w-2xl"></div>
    </div>

    <!-- 幻灯片 3：光疗系统 -->
    <div id="slide-light-therapy" class="slide flex-col items-center justify-center p-8 md:p-12" style="background-color: #C7D3BF;">
        <div class="z-10 text-center">
            <h1 class="title text-3xl md:text-4xl mb-4">科学光疗系统</h1>
            <p class="subtitle text-lg md:text-xl text-[#8D7B74]">根据不同波长，精准解决产后恢复问题</p>
        </div>
        <div class="flex flex-col md:flex-row justify-center items-stretch gap-4 md:gap-8 w-full max-w-5xl mt-8">
            <div class="light-card flex-1 p-6 flex flex-col items-center text-center">
                <div class="icon-container bg-[#F4E5E1] mb-4">
                    <i class="fas fa-sun text-4xl text-[#A57F75]"></i>
                </div>
                <h3 class="font-bold text-xl text-[#5A4A42] mb-2">红光</h3>
                <p class="text-[#5A4A42] mb-3">630-660nm波长</p>
                <div class="w-full bg-[#A57F75] rounded-lg p-3 mb-3">
                    <p class="text-white font-bold">身体恢复 & 伤口愈合</p>
                </div>
                <p class="text-[#5A4A42] text-sm">能够穿透皮肤表层，促进细胞新陈代谢和血液循环，加速产后伤口和妊娠纹修复</p>
            </div>
            <div class="light-card flex-1 p-6 flex flex-col items-center text-center">
                <div class="icon-container bg-[#C7D3BF] mb-4">
                    <i class="fas fa-moon text-4xl text-[#6B8E9F]"></i>
                </div>
                <h3 class="font-bold text-xl text-[#5A4A42] mb-2">天青光</h3>
                <p class="text-[#5A4A42] mb-3">480-500nm波长</p>
                <div class="w-full bg-[#6B8E9F] rounded-lg p-3 mb-3">
                    <p class="text-white font-bold">改善睡眠 & 调节昼夜节律</p>
                </div>
                <p class="text-[#5A4A42] text-sm">产后荷尔蒙波动及夜间哺乳常导致妈妈的昼夜节律紊乱，天青光能有效改善失眠和睡眠碎片化问题</p>
            </div>
            <div class="light-card flex-1 p-6 flex flex-col items-center text-center">
                <div class="icon-container bg-[#E6D7E7] mb-4">
                    <i class="fas fa-lightbulb text-4xl text-[#8D7B74]"></i>
                </div>
                <h3 class="font-bold text-xl text-[#5A4A42] mb-2">互动光</h3>
                <p class="text-[#5A4A42] mb-3">动态变化的柔和光影</p>
                <div class="w-full bg-[#8D7B74] rounded-lg p-3 mb-3">
                    <p class="text-white font-bold">情绪舒缓 & 亲子互动</p>
                </div>
                <p class="text-[#5A4A42] text-sm">创造安全感和趣味性环境，有效舒缓产后妈妈的紧张和焦虑情绪，增进母婴间的情感连接</p>
            </div>
        </div>
        <div class="mt-8 text-center text-sm text-[#5A4A42] opacity-70 z-10">
            <p>Meta分析表明，红光治疗组的伤口愈合总有效率显著高于对照组 (RR=1.21)</p>
        </div>
    </div>

    <!-- 幻灯片 4：声音疗愈 -->
    <div id="slide-sound-healing" class="slide flex-col items-center justify-center p-8 md:p-12" style="background-color: #E6D7E7;">
        <div class="z-10 text-center">
            <h1 class="title text-3xl md:text-4xl mb-4">专业声疗系统</h1>
            <p class="subtitle text-lg md:text-xl text-[#8D7B74]">为身心提供深层次的疗愈和放松</p>
        </div>
        <div class="flex flex-col md:flex-row justify-center items-center gap-4 md:gap-8 w-full max-w-5xl mt-8">
            <div class="text-center w-full md:w-1/2">
                <div class="p-6 bg-[#F8F4F1] rounded-xl shadow-lg">
                    <h3 class="font-bold text-2xl text-[#5A4A42] mb-2">定制化声景</h3>
                    <p class="text-[#5A4A42] text-lg mb-4">自然白噪音、ASMR、专属音乐</p>
                    <p class="text-[#5A4A42] text-sm opacity-80">根据产妇不同阶段情绪和需求，提供专业的声学设计，有效安抚情绪，缓解压力，为产妇带来平静与舒适</p>
                </div>
            </div>
            <div class="w-full md:w-1/2 flex items-center justify-center">
                <svg id="sound-waves" class="w-full h-40"></svg>
            </div>
        </div>
    </div>

    <!-- 幻灯片 5：现场服务 -->
    <div id="slide-on-site-service" class="slide flex-col items-center justify-center p-8 md:p-12">
        <div class="z-10 text-center">
            <h1 class="title text-3xl md:text-4xl mb-4">效果显著，数据说话</h1>
            <p class="subtitle text-lg md:text-xl text-[#8D7B74]">产后情绪和睡眠得到显著改善</p>
        </div>
        <div class="flex flex-col md:flex-row items-center justify-center gap-8 w-full max-w-5xl mt-8">
            <div class="w-full md:w-1/2">
                <h3 class="text-center text-xl font-bold text-[#A57F75] mb-4">产后情绪改善度</h3>
                <div id="emotion-chart" class="d3-chart w-full h-64"></div>
            </div>
            <div class="w-full md:w-1/2">
                <h3 class="text-center text-xl font-bold text-[#6B8E9F] mb-4">产后睡眠改善度</h3>
                <div id="sleep-chart" class="d3-chart w-full h-64"></div>
            </div>
        </div>
    </div>

    <!-- 幻灯片 6：双赢价值 -->
    <div id="slide-win-win" class="slide flex-col items-center justify-center p-8 md:p-12">
        <div class="z-10 text-center">
            <h1 class="title text-3xl md:text-4xl mb-4">双赢价值，共创未来</h1>
            <p class="subtitle text-lg md:text-xl text-[#8D7B74]">赋能月子中心，提升品牌竞争力</p>
        </div>
        <div id="value-chart" class="d3-chart mt-8 w-full max-w-2xl"></div>
    </div>

    <!-- 幻灯片 7：3步落地 -->
    <div id="slide-implementation" class="slide flex-col items-center justify-center p-8 md:p-12">
        <div class="z-10 text-center">
            <h1 class="title text-3xl md:text-4xl mb-4">3步轻松落地</h1>
            <p class="subtitle text-lg md:text-xl text-[#8D7B74]">从方案设计到持续优化，我们全程陪伴</p>
        </div>
        <div id="timeline-chart" class="d3-chart w-full h-40 mt-8 max-w-5xl"></div>
        <div class="flex flex-wrap justify-center gap-4 mt-8 w-full max-w-5xl text-center text-[#8D7B74]">
            <div class="flex-1 min-w-[200px] p-4 bg-[#F4E5E1] rounded-xl shadow-md">
                <p class="font-bold text-lg mb-1">方案设计与定制</p>
                <p class="text-sm">专业团队根据月子中心实际情况，定制声光疗愈方案</p>
            </div>
            <div class="flex-1 min-w-[200px] p-4 bg-[#F4E5E1] rounded-xl shadow-md">
                <p class="font-bold text-lg mb-1">实施与培训</p>
                <p class="text-sm">指导样板房建设，并对一线服务人员进行专业培训</p>
            </div>
            <div class="flex-1 min-w-[200px] p-4 bg-[#F4E5E1] rounded-xl shadow-md">
                <p class="font-bold text-lg mb-1">效果评估与优化</p>
                <p class="text-sm">定期跟踪服务效果，根据反馈持续优化方案</p>
            </div>
        </div>
    </div>

    <!-- 幻灯片 8：联系我们 -->
    <div id="slide-contact" class="slide flex-col items-center justify-center p-8 md:p-12">
        <div class="z-10 text-center">
            <h1 class="title text-3xl md:text-4xl mb-4">联系我们</h1>
            <p class="subtitle text-lg md:text-xl text-[#8D7B74]">携手共创母婴服务新纪元，引领高端月子中心的发展趋势</p>
        </div>
        <div class="contact-card p-8 w-full max-w-3xl mt-8">
            <h3 class="font-bold text-xl text-[#5A4A42] mb-6 text-center">合作諮詢</h3>
            <div class="flex flex-col md:flex-row justify-center items-center gap-8 md:gap-16">
                <div class="flex items-center">
                    <div class="icon-container bg-[#F4E5E1] flex-shrink-0">
                        <i class="fas fa-phone text-2xl text-[#A57F75]"></i>
                    </div>
                    <div class="ml-4 text-center md:text-left">
                        <p class="text-sm text-[#8D7B74]">諮詢專線</p>
                        <p class="text-lg text-[#5A4A42] font-medium">18102535583</p>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="icon-container bg-[#E6D7E7] flex-shrink-0">
                        <i class="fab fa-weixin text-2xl text-[#8D7B74]"></i>
                    </div>
                    <div class="ml-4 text-center md:text-left">
                        <p class="text-sm text-[#8D7B74]">微信</p>
                        <p class="text-lg text-[#5A4A42] font-medium">Joseph5784</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- 幻灯片控制按钮 -->
<div class="control-buttons">
    <button id="prev-btn" disabled>上一页</button>
    <button id="next-btn">下一页</button>
</div>

<script>
    // 定义所有幻灯片
    const slides = [
        'slide-cover',
        'slide-challenges',
        'slide-light-therapy',
        'slide-sound-healing',
        'slide-on-site-service',
        'slide-win-win',
        'slide-implementation',
        'slide-contact'
    ];
    let currentSlideIndex = 0;
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    // 显示当前幻灯片
    function showSlide(index) {
        // 隐藏所有幻灯片
        document.querySelectorAll('.slide').forEach(slide => {
            slide.style.display = 'none';
        });
        // 显示当前幻灯片
        const currentSlide = document.getElementById(slides[index]);
        currentSlide.style.display = 'flex';

        // 重新绘制图表或启动动画
        const slideId = slides[index];
        if (slideId === 'slide-challenges') {
            drawChallengeChart();
        } else if (slideId === 'slide-sound-healing') {
            animateSoundWaves();
        } else if (slideId === 'slide-on-site-service') {
            drawEmotionChart();
            drawSleepChart();
        } else if (slideId === 'slide-win-win') {
            drawValueChart();
        } else if (slideId === 'slide-implementation') {
            drawTimelineChart();
        }
        
        // 更新按钮状态
        prevBtn.disabled = index === 0;
        nextBtn.disabled = index === slides.length - 1;
    }

    // 绘制挑战图表
    function drawChallengeChart() {
        // 清除旧的图表
        d3.select("#challenge-chart").selectAll("*").remove();
        
        const data = [
            { challenge: "情绪波动", percentage: 90, color: "#A57F75" },
            { challenge: "睡眠障碍", percentage: 80, color: "#6B8E9F" },
            { challenge: "身体恢复", percentage: 75, color: "#8D7B74" }
        ];

        const margin = { top: 20, right: 20, bottom: 20, left: 150 };
        const chartContainer = document.getElementById('challenge-chart');
        const containerWidth = chartContainer.clientWidth;
        const containerHeight = chartContainer.clientHeight;
        const width = containerWidth - margin.left - margin.right;
        const height = containerHeight - margin.top - margin.bottom;

        const svg = d3.select("#challenge-chart")
            .append("svg")
            .attr("width", containerWidth)
            .attr("height", containerHeight)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);
        
        const y = d3.scaleBand()
            .range([0, height])
            .domain(data.map(d => d.challenge))
            .padding(0.4);

        const x = d3.scaleLinear()
            .range([0, width])
            .domain([0, 100]);

        const barHeight = y.bandwidth();
        const maxBarWidth = width;

        const barGroups = svg.selectAll(".bar-group")
            .data(data)
            .enter()
            .append("g")
            .attr("transform", d => `translate(0, ${y(d.challenge)})`);

        // Challenge label
        barGroups.append("text")
            .attr("x", -10)
            .attr("y", barHeight / 2)
            .attr("text-anchor", "end")
            .attr("dominant-baseline", "middle")
            .attr("fill", "#5A4A42")
            .attr("font-size", "14px")
            .text(d => d.challenge);
            
        // Background bar
        barGroups.append("rect")
            .attr("width", maxBarWidth)
            .attr("height", barHeight)
            .attr("rx", 10)
            .attr("ry", 10)
            .attr("fill", "#F4E5E1")
            .attr("opacity", 0.5);

        // Percentage bar
        barGroups.append("rect")
            .attr("width", d => (d.percentage / 100) * maxBarWidth)
            .attr("height", barHeight)
            .attr("rx", 10)
            .attr("ry", 10)
            .attr("fill", d => d.color);
        
        // Percentage text
        barGroups.append("text")
            .attr("x", d => (d.percentage / 100) * maxBarWidth - 20)
            .attr("y", barHeight / 2)
            .attr("text-anchor", "end")
            .attr("dominant-baseline", "middle")
            .attr("fill", "white")
            .attr("font-size", "14px")
            .attr("font-weight", "bold")
            .text(d => d.percentage + "%");
    }

    // 绘制情绪图表
    function drawEmotionChart() {
        d3.select("#emotion-chart").selectAll("*").remove();

        const data = [
            { stage: "治疗前", score: 25, color: "#A57F75" },
            { stage: "治疗后", score: 12, color: "#C7D3BF" }
        ];
        
        const margin = { top: 30, right: 30, bottom: 30, left: 30 };
        const chartContainer = document.getElementById('emotion-chart');
        const containerWidth = chartContainer.clientWidth;
        const containerHeight = chartContainer.clientHeight;
        const width = containerWidth - margin.left - margin.right;
        const height = containerHeight - margin.top - margin.bottom;

        const svg = d3.select("#emotion-chart")
            .append("svg")
            .attr("width", containerWidth)
            .attr("height", containerHeight)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);
        
        const x = d3.scaleBand()
            .range([0, width])
            .domain(data.map(d => d.stage))
            .padding(0.4);

        const y = d3.scaleLinear()
            .range([height, 0])
            .domain([0, 30]);

        // Add X-axis
        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x).tickSize(0).tickPadding(10))
            .call(g => g.select(".domain").remove())
            .selectAll("text")
            .attr("fill", "#5A4A42")
            .attr("font-size", "16px");
            
        // Add Y-axis
        svg.append("g")
            .call(d3.axisLeft(y).ticks(5).tickSize(-width))
            .call(g => g.select(".domain").remove())
            .call(g => g.selectAll(".tick line").attr("stroke-opacity", 0.1))
            .selectAll("text")
            .attr("fill", "#8D7B74")
            .attr("font-size", "12px");

        // Add bars
        svg.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", d => x(d.stage))
            .attr("y", d => y(d.score))
            .attr("width", x.bandwidth())
            .attr("height", d => height - y(d.score))
            .attr("rx", 5)
            .attr("ry", 5)
            .attr("fill", d => d.color);

        // Add labels
        svg.selectAll(".label")
            .data(data)
            .enter()
            .append("text")
            .attr("class", "label")
            .attr("x", d => x(d.stage) + x.bandwidth() / 2)
            .attr("y", d => y(d.score) - 10)
            .attr("text-anchor", "middle")
            .attr("font-size", "16px")
            .attr("font-weight", "bold")
            .attr("fill", d => d.color)
            .text(d => d.score);
            
        // Add arrow to show the reduction
        svg.append("path")
            .attr("d", `M${x("治疗前") + x.bandwidth() + 10},${y(12)} L${x("治疗后") - 10},${y(12)}`)
            .attr("stroke", "#8D7B74")
            .attr("stroke-width", 2)
            .attr("marker-end", "url(#arrow)");
        
        // Add arrowhead marker
        svg.append("defs").append("marker")
            .attr("id", "arrow")
            .attr("viewBox", "0 -5 10 10")
            .attr("refX", 5)
            .attr("refY", 0)
            .attr("markerWidth", 6)
            .attr("markerHeight", 6)
            .attr("orient", "auto")
            .append("path")
            .attr("d", "M0,-5L10,0L0,5")
            .attr("fill", "#8D7B74");
    }

    // 绘制睡眠图表
    function drawSleepChart() {
        d3.select("#sleep-chart").selectAll("*").remove();

        const data = [
            { stage: "治疗前", score: 18, color: "#6B8E9F" },
            { stage: "治疗后", score: 7, color: "#E6D7E7" }
        ];

        const margin = { top: 30, right: 30, bottom: 30, left: 30 };
        const chartContainer = document.getElementById('sleep-chart');
        const containerWidth = chartContainer.clientWidth;
        const containerHeight = chartContainer.clientHeight;
        const width = containerWidth - margin.left - margin.right;
        const height = containerHeight - margin.top - margin.bottom;

        const svg = d3.select("#sleep-chart")
            .append("svg")
            .attr("width", containerWidth)
            .attr("height", containerHeight)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);
        
        const x = d3.scaleBand()
            .range([0, width])
            .domain(data.map(d => d.stage))
            .padding(0.4);

        const y = d3.scaleLinear()
            .range([height, 0])
            .domain([0, 20]);
        
        // Add X-axis
        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x).tickSize(0).tickPadding(10))
            .call(g => g.select(".domain").remove())
            .selectAll("text")
            .attr("fill", "#5A4A42")
            .attr("font-size", "16px");

        // Add Y-axis
        svg.append("g")
            .call(d3.axisLeft(y).ticks(5).tickSize(-width))
            .call(g => g.select(".domain").remove())
            .call(g => g.selectAll(".tick line").attr("stroke-opacity", 0.1))
            .selectAll("text")
            .attr("fill", "#8D7B74")
            .attr("font-size", "12px");

        // Add bars
        svg.selectAll(".bar")
            .data(data)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("x", d => x(d.stage))
            .attr("y", d => y(d.score))
            .attr("width", x.bandwidth())
            .attr("height", d => height - y(d.score))
            .attr("rx", 5)
            .attr("ry", 5)
            .attr("fill", d => d.color);

        // Add labels
        svg.selectAll(".label")
            .data(data)
            .enter()
            .append("text")
            .attr("class", "label")
            .attr("x", d => x(d.stage) + x.bandwidth() / 2)
            .attr("y", d => y(d.score) - 10)
            .attr("text-anchor", "middle")
            .attr("font-size", "16px")
            .attr("font-weight", "bold")
            .attr("fill", d => d.color)
            .text(d => d.score);
            
        // Add arrow
        svg.append("path")
            .attr("d", `M${x("治疗前") + x.bandwidth() + 10},${y(7)} L${x("治疗后") - 10},${y(7)}`)
            .attr("stroke", "#8D7B74")
            .attr("stroke-width", 2)
            .attr("marker-end", "url(#arrow-sleep)");
            
        // Add arrowhead marker
        svg.append("defs").append("marker")
            .attr("id", "arrow-sleep")
            .attr("viewBox", "0 -5 10 10")
            .attr("refX", 5)
            .attr("refY", 0)
            .attr("markerWidth", 6)
            .attr("markerHeight", 6)
            .attr("orient", "auto")
            .append("path")
            .attr("d", "M0,-5L10,0L0,5")
            .attr("fill", "#8D7B74");
    }

    // 绘制价值图表
    function drawValueChart() {
        d3.select("#value-chart").selectAll("*").remove();

        const data = [
            { category: "提升客户满意度", value: 95, color: "#A57F75" },
            { category: "增加服务收入", value: 80, color: "#6B8E9F" },
            { category: "建立品牌口碑", value: 90, color: "#8D7B74" }
        ];

        const margin = { top: 20, right: 20, bottom: 20, left: 150 };
        const chartContainer = document.getElementById('value-chart');
        const containerWidth = chartContainer.clientWidth;
        const containerHeight = chartContainer.clientHeight;
        const width = containerWidth - margin.left - margin.right;
        const height = containerHeight - margin.top - margin.bottom;

        const svg = d3.select("#value-chart")
            .append("svg")
            .attr("width", containerWidth)
            .attr("height", containerHeight)
            .append("g")
            .attr("transform", `translate(${margin.left}, ${margin.top})`);
        
        const y = d3.scaleBand()
            .range([0, height])
            .domain(data.map(d => d.category))
            .padding(0.4);

        const barHeight = y.bandwidth();
        const maxBarWidth = width;

        const barGroups = svg.selectAll(".bar-group")
            .data(data)
            .enter()
            .append("g")
            .attr("transform", d => `translate(0, ${y(d.category)})`);

        // Background bar
        barGroups.append("rect")
            .attr("width", maxBarWidth)
            .attr("height", barHeight)
            .attr("rx", 15)
            .attr("ry", 15)
            .attr("fill", "#F4E5E1")
            .attr("opacity", 0.5);
        
        // Percentage bar
        barGroups.append("rect")
            .attr("width", d => (d.value / 100) * maxBarWidth)
            .attr("height", barHeight)
            .attr("rx", 15)
            .attr("ry", 15)
            .attr("fill", d => d.color);
        
        // Labels
        barGroups.append("text")
            .attr("x", -20)
            .attr("y", barHeight / 2)
            .attr("text-anchor", "end")
            .attr("dominant-baseline", "middle")
            .attr("fill", "#5A4A42")
            .attr("font-size", "14px")
            .attr("font-weight", "bold")
            .text(d => d.category);
        
        // Percentage text
        barGroups.append("text")
            .attr("x", d => (d.value / 100) * maxBarWidth - 10)
            .attr("y", barHeight / 2)
            .attr("text-anchor", "end")
            .attr("dominant-baseline", "middle")
            .attr("fill", "white")
            .attr("font-size", "14px")
            .attr("font-weight", "bold")
            .text(d => d.value + "%");
    }

    // 绘制时间线
    function drawTimelineChart() {
        d3.select("#timeline-chart").selectAll("*").remove();

        const timelineData = [
            { phase: "方案设计", position: 0.1, color: "#A57F75" },
            { phase: "样板房建设", position: 0.25, color: "#A57F75" },
            { phase: "设备采购", position: 0.4, color: "#6B8E9F" },
            { phase: "人员培训", position: 0.55, color: "#6B8E9F" },
            { phase: "服务推出", position: 0.7, color: "#8D7B74" },
            { phase: "持续优化", position: 0.85, color: "#8D7B74" }
        ];

        const margin = { top: 20, right: 20, bottom: 20, left: 20 };
        const chartContainer = document.getElementById('timeline-chart');
        const containerWidth = chartContainer.clientWidth;
        const containerHeight = chartContainer.clientHeight;
        const width = containerWidth - margin.left - margin.right;
        const height = containerHeight - margin.top - margin.bottom;

        const svg = d3.select("#timeline-chart")
            .append("svg")
            .attr("width", containerWidth)
            .attr("height", containerHeight)
            .append("g")
            .attr("transform", `translate(${margin.left}, ${margin.top})`);
        
        // Draw timeline
        svg.append("line")
            .attr("x1", 50)
            .attr("y1", height / 2)
            .attr("x2", width - 50)
            .attr("y2", height / 2)
            .attr("stroke", "#C7D3BF")
            .attr("stroke-width", 3);
        
        // Draw timeline points and labels
        svg.selectAll("circle")
            .data(timelineData)
            .enter()
            .append("circle")
            .attr("cx", d => 50 + (width - 100) * d.position)
            .attr("cy", height / 2)
            .attr("r", 8)
            .attr("fill", d => d.color)
            .attr("stroke", "#FFF8F4")
            .attr("stroke-width", 3);
            
        svg.selectAll("text.label")
            .data(timelineData)
            .enter()
            .append("text")
            .attr("class", "label")
            .attr("x", d => 50 + (width - 100) * d.position)
            .attr("y", height / 2 - 20)
            .attr("text-anchor", "middle")
            .attr("font-size", "14px")
            .attr("fill", "#5A4A42")
            .text(d => d.phase);
    }

    // 声音疗愈动画
    function animateSoundWaves() {
        d3.select("#sound-waves").selectAll("*").remove();

        const svg = d3.select("#sound-waves");
        const chartContainer = document.getElementById('sound-waves');
        const containerWidth = chartContainer.clientWidth;
        const containerHeight = chartContainer.clientHeight;
        const width = containerWidth;
        const height = containerHeight;
        
        // Clear old content
        svg.attr("width", width)
           .attr("height", height)
           .selectAll("*").remove();

        // 创建4个圆圈，代表声波
        const circle1 = svg.append("circle")
            .attr("r", 10)
            .attr("cy", height / 2)
            .attr("fill", "#A57F75")
            .attr("opacity", 0.5);

        const circle2 = svg.append("circle")
            .attr("r", 10)
            .attr("cy", height / 2)
            .attr("fill", "#C7D3BF")
            .attr("opacity", 0.5);

        const circle3 = svg.append("circle")
            .attr("r", 10)
            .attr("cy", height / 2)
            .attr("fill", "#6B8E9F")
            .attr("opacity", 0.5);

        const circle4 = svg.append("circle")
            .attr("r", 10)
            .attr("cy", height / 2)
            .attr("fill", "#8D7B74")
            .attr("opacity", 0.5);

        function animate() {
            // 每次动画循环时，重新计算宽度
            const currentWidth = d3.select("#sound-waves").node().clientWidth;
            const duration = 4000;

            circle1.attr("cx", 0)
                .transition()
                .duration(duration)
                .ease(d3.easeLinear)
                .attr("cx", currentWidth)
                .on("end", animate);

            circle2.attr("cx", currentWidth / 3)
                .transition()
                .duration(duration)
                .ease(d3.easeLinear)
                .attr("cx", currentWidth + currentWidth / 3)
                .on("end", () => {
                    circle2.attr("cx", -currentWidth / 3)
                        .transition().duration(0).on("end", animate);
                });

            circle3.attr("cx", 2 * currentWidth / 3)
                .transition()
                .duration(duration)
                .ease(d3.easeLinear)
                .attr("cx", currentWidth + 2 * currentWidth / 3)
                .on("end", () => {
                    circle3.attr("cx", -currentWidth / 3)
                        .transition().duration(0).on("end", animate);
                });

            circle4.attr("cx", currentWidth)
                .transition()
                .duration(duration)
                .ease(d3.easeLinear)
                .attr("cx", 2 * currentWidth)
                .on("end", () => {
                    circle4.attr("cx", -currentWidth)
                        .transition().duration(0).on("end", animate);
                });
        }
        
        // 绑定窗口大小改变事件，以便重新绘制图表和动画
        window.addEventListener('resize', () => {
            const currentSlideId = slides[currentSlideIndex];
            if (currentSlideId === 'slide-challenges') {
                drawChallengeChart();
            } else if (currentSlideId === 'slide-sound-healing') {
                animateSoundWaves();
            } else if (currentSlideId === 'slide-on-site-service') {
                drawEmotionChart();
                drawSleepChart();
            } else if (currentSlideId === 'slide-win-win') {
                drawValueChart();
            } else if (currentSlideId === 'slide-implementation') {
                drawTimelineChart();
            }
        });

        animate();
    }
    
    // 初始化幻灯片
    document.addEventListener('DOMContentLoaded', () => {
        showSlide(currentSlideIndex);
    });

    // 绑定事件监听器
    prevBtn.addEventListener('click', () => {
        if (currentSlideIndex > 0) {
            currentSlideIndex--;
            showSlide(currentSlideIndex);
        }
    });

    nextBtn.addEventListener('click', () => {
        if (currentSlideIndex < slides.length - 1) {
            currentSlideIndex++;
            showSlide(currentSlideIndex);
        }
    });
</script>

</body>
</html>
